function [mus,icov,pii]=fitMOGm_hir_ws(xL,mN,ws)
% L is the maximum size of patch we want to learn
L=ws-1;    
% N = num of patches in xL
N=size(xL,3);
%
hxs=ceil(size(xL,1)/2);
%
itrsN=100;
% init p
p=[];
%start iterations
for itr=1:L
    
   tws=itr+1;
   %calc the sizes of the patches we will use
   hws1=floor((tws-1)/2)
   hws2=ceil((tws-1)/2)
   
   xL0=xL(hxs-hws1:hxs+hws2,hxs-hws1:hxs+hws2,1:N);
   x=reshape(xL0,tws^2,N);
   %keyboard
   [mus,icov,pii,p]=fitMOGm(x,mN,p,itrsN);
end
